# VERSION: 2d4307a
# THIS FILE IS AUTOGENERATED - DO NOT EDIT
# Source: https://github.com/Software-Automation-Holdings-LLC/developer-common/blob/968d7b9ece8ab9b8aa66832b63567e3ca34c458a/github-workflow-templates/pre-commit-cursor.yml

name: Pre-commit for Cursor PRs

on:
  pull_request:
    types: [opened, synchronize]

  # Allow manual trigger for testing
  workflow_dispatch:
    inputs:
      pr_number:
        description: "PR number to run pre-commit on"
        required: true
        type: string

# Restrict default permissions - expanded at job level
permissions: {}

# Only allow one pre-commit run at a time per PR
concurrency:
  group: pre-commit-${{ github.repository }}-${{ github.event.pull_request.number || github.event.inputs.pr_number }}
  cancel-in-progress: true # Cancel older runs if new commits pushed

jobs:
  pre-commit:
    # Run for Cursor PRs (branch prefix), or manual trigger
    if: |
      github.event_name == 'workflow_dispatch' ||
      startsWith(github.event.pull_request.head.ref, 'cursor/')
    permissions:
      contents: write
      pull-requests: write
    uses: Software-Automation-Holdings-LLC/developer-common/.github/workflows/pre-commit-cursor.yml@968d7b9ece8ab9b8aa66832b63567e3ca34c458a
    with:
      auto_fix: true
      pr_number: ${{ github.event.inputs.pr_number || '' }}
    secrets:
      DEV_BOT_APP_ID: ${{ secrets.DEV_BOT_APP_ID }}
      DEV_BOT_PRIVATE_KEY: ${{ secrets.DEV_BOT_PRIVATE_KEY }}
      LINEAR_API_KEY: ${{ secrets.LINEAR_API_KEY }}
      ZB_PAT: ${{ secrets.ZB_PAT }}
