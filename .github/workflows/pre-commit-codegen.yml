# VERSION: 1ca9f11
# THIS FILE IS AUTOGENERATED - DO NOT EDIT
# Source: https://github.com/Software-Automation-Holdings-LLC/developer-common/blob/b7889e056e06316664b15f27fe9c6577cb3fba77/github-workflow-templates/pre-commit-codegen.yml

name: Pre-commit for Codegen PRs

on:
  pull_request:
    types: [opened, synchronize]

  # Allow manual trigger for testing
  workflow_dispatch:
    inputs:
      pr_number:
        description: "PR number to run pre-commit on"
        required: true
        type: string

# Restrict default permissions - expanded at job level
permissions: {}

# Only allow one pre-commit run at a time per PR
concurrency:
  group: pre-commit-${{ github.repository }}-${{ github.event.pull_request.number || github.event.inputs.pr_number }}
  cancel-in-progress: true # Cancel older runs if new commits pushed

jobs:
  pre-commit:
    # Run for codegen PRs, or manual trigger
    if: |
      github.event_name == 'workflow_dispatch' ||
      github.event.pull_request.user.login == 'codegen-sh[bot]'
    permissions:
      contents: write
      pull-requests: write
    uses: Software-Automation-Holdings-LLC/developer-common/.github/workflows/pre-commit-codegen.yml@b7889e056e06316664b15f27fe9c6577cb3fba77
    with:
      auto_fix: true
      pr_number: ${{ github.event.inputs.pr_number || '' }}
    secrets:
      DEV_BOT_APP_ID: ${{ secrets.DEV_BOT_APP_ID }}
      DEV_BOT_PRIVATE_KEY: ${{ secrets.DEV_BOT_PRIVATE_KEY }}
      LINEAR_API_KEY: ${{ secrets.LINEAR_API_KEY }}
